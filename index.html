<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
  <title>AR Meishi TechConnect</title>
  <script>
    // Service Worker登録
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('[SW] Registered:', reg.scope))
          .catch(err => console.log('[SW] Registration failed:', err));
      });
    }
  </script>
  <style>
    body {
      margin: 0;
    }

    .example-container {
      overflow: hidden;
      position: absolute;
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <div class="example-container">

    <a-scene mindar-image="imageTargetSrc: ./assets/target.mind; autoStart: true;" color-space="sRGB"
      renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false">

      <a-assets timeout="30000">
        <img id="card-front" src="./assets/meishi_front.png" />
        <img id="card-inside" src="./assets/meishi_inside.png" />
        <!-- Video Asset -->
        <video id="logo-video" src="./assets/logoanimation.mp4" crossorigin="anonymous" playsinline webkit-playsinline
          muted></video>
        <!-- Intro Assets -->
        <img id="intro-profile" src="./assets/intro_profile.jpg" />
        <img id="intro-name" src="./assets/intro_name.png" />
        <img id="intro-job" src="./assets/intro_job.png" />
        <img id="intro-catch" src="./assets/intro_catch.png" />
        <!-- Icons -->
        <img id="icon-instagram" src="./assets/icon_instagram.png" />
        <img id="icon-website" src="./assets/icon_website.png" />
        <img id="icon-portfolio" src="./assets/icon_potfolio.png" />
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;"
        raycaster="far: 10000; objects: .clickable"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">

        <!-- Container for the whole card -->
        <a-entity position="0 0 0">

          <!-- Base (Inside Content - Black Background for Hologram) -->
          <a-plane id="base-card" position="0 0 0" width="1" height="0.6" material="color: #000; side: front">
          </a-plane>

          <!-- Logo Entity (Hologram style) - Video -->
          <!-- Placed flat on the center of the opened card (y=0.3). -->
          <!-- Appears after card opens. Moves up to header later. -->
          <a-video id="logo" src="#logo-video" position="0 0.3 0.02" width="0.9" height="0.5" scale="0 0 0"
            rotation="0 0 0"
            animation__scale="property: scale; to: 1 1 1; dur: 1000; delay: 2500; easing: easeOutQuad; startEvents: open"
            animation__move="property: position; to: 0 1.2 0.02; dur: 1000; easing: easeInOutQuad; startEvents: moveHeader"
            material="opacity: 1; transparent: true;">
          </a-video>

          <!-- Intro Container (Hologram) -->
          <!-- Initially invisible. Appears below header logo. -->
          <!-- Moved higher for vertical stack. -->
          <a-entity id="intro-container" position="0 0.1 0.05" opacity="0"
            animation__fade="property: opacity; to: 1; dur: 1000; easing: linear; startEvents: showIntro">

            <!-- 1. Catchphrase (Top) -->
            <!-- Aspect Ratio 1075:650 ~= 1.65 -->
            <!-- Float: y 0.65 -> 0.7, z 0.02 -->
            <a-image src="#intro-catch" position="0 0.65 0.02" width="1.2" height="0.72" opacity="0"
              material="transparent: true; alphaTest: 0.1"
              animation="property: opacity; to: 1; dur: 800; delay: 1300; startEvents: showIntro"
              animation__float="property: position; to: 0 0.7 0.02; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 2000; startEvents: showIntro">
            </a-image>

            <!-- 2. Job Title (Below Catch) -->
            <!-- Grouped with Name for "Lastly" appearance -->
            <!-- Float: y 0.45 -> 0.5, z 0.02 -->
            <a-image src="#intro-job" position="0 0.45 0.02" width="1.2" height="0.72" opacity="0"
              material="transparent: true; alphaTest: 0.1"
              animation="property: opacity; to: 1; dur: 800; delay: 1300; startEvents: showIntro"
              animation__float="property: position; to: 0 0.5 0.02; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 2200; startEvents: showIntro">
            </a-image>

            <!-- 3. Profile Photo (Center) - Larger -->
            <!-- Pop up scaling (Slower: 1200ms) -->
            <!-- Float: y 0.1 -> 0.15, z 0.05 (Most forward) -->
            <a-circle src="#intro-profile" position="0 0.1 0.05" radius="0.25" scale="0 0 0" opacity="1"
              animation="property: scale; to: 1 1 1; dur: 1200; delay: 1800; easing: easeOutElastic; startEvents: showIntro"
              animation__float="property: position; to: 0 0.15 0.05; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 2400; startEvents: showIntro">
            </a-circle>

            <!-- 4. Name (Bottom) -->
            <!-- Appears smoothly at the end -->
            <!-- Float: y -0.25 -> -0.2, z 0.02 -->
            <a-image src="#intro-name" position="0 -0.25 0.02" width="1.2" height="0.72" opacity="0"
              material="transparent: true; alphaTest: 0.1"
              animation="property: opacity; to: 1; dur: 1000; delay: 2100; startEvents: showIntro"
              animation__float="property: position; to: 0 -0.2 0.02; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 2600; startEvents: showIntro">
            </a-image>

          </a-entity>

          <!-- Website Button (Left) -->
          <!-- Positioned at x = -0.35 (Widened Spacing) -->
          <a-entity id="btn-website" position="-0.35 -0.45 0.05" scale="0 0 0" class="clickable"
            geometry="primitive: circle; radius: 0.15"
            material="color: #FFF; shader: flat; transparent: true; opacity: 0"
            animation="property: scale; to: 1 1 1; dur: 1000; delay: 2800; easing: easeOutElastic; startEvents: showIntro"
            animation__float="property: position; to: -0.35 -0.4 0.05; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 2800; startEvents: showIntro">

            <!-- Glass Background (Circle) -->
            <a-circle radius="0.15" color="#ffffff" opacity="0.2" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-circle>
            <!-- Border (Ring) -->
            <a-ring radius-inner="0.15" radius-outer="0.155" color="#ffffff" opacity="0.4" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-ring>

            <!-- Icon -->
            <a-image src="#icon-website" position="0 0 0.01" width="0.15" height="0.15" transparent="true"></a-image>
          </a-entity>


          <!-- Instagram Button (Center) -->
          <!-- Positioned at x = 0 -->
          <a-entity id="btn-instagram" position="0 -0.45 0.05" scale="0 0 0" class="clickable"
            geometry="primitive: circle; radius: 0.15"
            material="color: #FFF; shader: flat; transparent: true; opacity: 0"
            animation="property: scale; to: 1 1 1; dur: 1000; delay: 3000; easing: easeOutElastic; startEvents: showIntro"
            animation__float="property: position; to: 0 -0.4 0.05; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 3000; startEvents: showIntro">

            <!-- Glass Background (Circle) -->
            <a-circle radius="0.15" color="#ffffff" opacity="0.2" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-circle>
            <!-- Border (Ring) -->
            <a-ring radius-inner="0.15" radius-outer="0.155" color="#ffffff" opacity="0.4" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-ring>

            <!-- Icon -->
            <a-image src="#icon-instagram" position="0 0 0.01" width="0.15" height="0.15" transparent="true"></a-image>
          </a-entity>

          <!-- Portfolio Button (Right) -->
          <!-- Positioned at x = 0.35 (Widened Spacing) -->
          <a-entity id="btn-portfolio" position="0.35 -0.45 0.05" scale="0 0 0" class="clickable"
            geometry="primitive: circle; radius: 0.15"
            material="color: #FFF; shader: flat; transparent: true; opacity: 0"
            animation="property: scale; to: 1 1 1; dur: 1000; delay: 3200; easing: easeOutElastic; startEvents: showIntro"
            animation__float="property: position; to: 0.35 -0.4 0.05; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine; delay: 3200; startEvents: showIntro">

            <!-- Glass Background (Circle) -->
            <a-circle radius="0.15" color="#ffffff" opacity="0.2" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-circle>
            <!-- Border (Ring) -->
            <a-ring radius-inner="0.15" radius-outer="0.155" color="#ffffff" opacity="0.4" position="0 0 0"
              material="transparent: true; shader: flat; side: double">
            </a-ring>

            <!-- Icon -->
            <a-image src="#icon-portfolio" position="0 0 0.01" width="0.25" height="0.25" transparent="true"></a-image>
          </a-entity>

          <!-- Portfolio Hologram Panel -->
          <!-- Initially hidden (scale 0), appears when button clicked -->
          <a-entity id="portfolio-panel" position="0 0.3 0.5" scale="0 0 0">
            <!-- Glass Background -->
            <a-plane width="1.2" height="1.0" color="#000000" opacity="0.7"
              material="transparent: true; shader: flat; side: double">
            </a-plane>
            <!-- Border Glow -->
            <a-plane width="1.22" height="1.02" position="0 0 -0.001" color="#00ffff" opacity="0.3"
              material="transparent: true; shader: flat; side: double">
            </a-plane>

            <!-- Title -->
            <a-text value="Production Results" position="0 0.35 0.01" align="center" color="#00ffff" width="2"
              font="mozillavr"></a-text>

            <!-- List Items -->
            <a-text value="• AR Flyer" position="-0.5 0.15 0.01" align="left" color="#ffffff" width="1.8"
              font="mozillavr"></a-text>
            <a-text value="• AR CD" position="-0.5 0.0 0.01" align="left" color="#ffffff" width="1.8"
              font="mozillavr"></a-text>
            <a-text value="• AR Photo Frame" position="-0.5 -0.15 0.01" align="left" color="#ffffff" width="1.8"
              font="mozillavr"></a-text>
            <a-text value="• AR Dinosaur BOX" position="-0.5 -0.3 0.01" align="left" color="#ffffff" width="1.8"
              font="mozillavr"></a-text>

            <!-- Close Button -->
            <a-entity id="btn-close-portfolio" position="0 -0.42 0.01" class="clickable"
              geometry="primitive: plane; width: 0.3; height: 0.1"
              material="color: #00ffff; opacity: 0.3; transparent: true; shader: flat">
              <a-text value="Close" position="0 0 0.01" align="center" color="#ffffff" width="1.5"></a-text>
            </a-entity>
          </a-entity>

          <!-- Cover Container (Pivot at Top Edge: y = 0.3) -->
          <a-entity id="cover-pivot" position="0 0.3 0" rotation="0 0 0"
            animation="property: rotation; to: -180 0 0; dur: 2000; delay: 500; easing: easeOutQuad; loop: false; startEvents: open">

            <!-- Cover Front (Outside) -->
            <a-plane id="cover-front" position="0 -0.3 0.01" width="1" height="0.6"
              material="src: #card-front; side: front">
            </a-plane>

            <!-- Cover Back (Inside - Black) -->
            <a-plane id="cover-back" position="0 -0.3 0" width="1" height="0.6" rotation="0 180 0"
              material="color: #000; side: front">
            </a-plane>

          </a-entity>

        </a-entity>
      </a-entity>
    </a-scene>
  </div>

  <script src="./script.js"></script>
</body>

</html>